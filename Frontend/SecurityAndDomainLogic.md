# 프론트앤드의 보안과 도메인 로직

## 애플리케이션이 백앤드 중심이 될 수 밖에 없는 이유

애플리케이션 설계가 백앤드 중심으로 이뤄질 수 밖에 없는 이유는 프론트앤드는 모든 소스코드가 노출이 되고, 프론트앤드에서 백앤드로 전달하는 값을 변조할 수 있기 때문이다.

프론트앤드에서는 가능한 사용자가 변경해도 되는 데이터만 다룰 수 있도록 하고, 각종 데이터의 중요한 변환은 백앤드에서 이뤄지도록 처리를 해야 한다.

각종 중요한 데이터 변환을 백앤드에서 처리하는 이유는 데이터의 변환 방식이 도메인에 관련된 로직이므로 서비스의 중요한 핵심 로직일 수 있기 때문에 가능한 노출을 하지 않는 것이 좋으며, 최종 결과 값을 조작해서 보낼 수 있는 프론트 앤드와 달리 백앤드에서는 조작의 개입 없이 데이터의 변환 과정 중에서 발생할 수 있는 부정한 개입을 방지할 수 있기 때문이다.

만약 각종 데이터에 대한 중요한 변환이 프론트앤드에서만 이뤄지게 되면, 백앤드는 단순히 프론트앤드에서 만들어진 데이터를 저장하는 저장소의 역할만 하게 된다. 각종 변환된 값을 변환 되기 전의 값으로 바꾸기는 어렵다. 어떤 연산이 이뤄진 후의 데이터를 검증하는 것 보다는 각종 연산이 이뤄지기 전에 잘못된 데이터를 미리 걸러내는 것이 유리하다. 

각종 변환된 데이터가 데이터베이스에 저장이 되면 중요한 순간 변환된 값이므로 해당 값을 수정하기 어려울 수 있고, 변환 과정에서 어떤 오류가 있다면 변환 전의 값에서 변환 후의 값으로의 변경을 잘 알 수 있어야 로직의 검증이 수월한데 프론트앤드의 결과값만을 받으므로 불가능한 경우가 생길 수 있다.

따라서 프론트앤드에서 값을 변환하여 백앤드를 저장소롤 사용하지 않고, 프론트앤드에서는 유저의 입력과 조작에 의한 입력한 값 그대로 또는 단순화된 데이터만을 받고, 디비에 저장을 하고 백앤드에서 복잡한 변환 처리를 하는 것이 좋다.

## 어디까지나 프레젠테이션 레이어

프론트앤드의 코드는 각종 비즈니스 로직, 데이터의 핵심 변환은 하지 않고, 프레젠테이션 레이어로서의 역할에 충실해야 한다. 백앤드에서 각종 가공된 데이터를 보여주기 위한 코드와 유저의 행위에 대한 각종 이벤트에 대한 반응으로 유저의 편의성을 돕는 로직에 집중해야 한다. 이는 웹의 보안적인 특징과 외부에 노출되는 데이터 이외의 감추어야 하는 비즈니스의 핵심 로직들을 감출 수 있기 때문이다.

프론트앤드와 백앤드가 분리 되었을 때, 프론트앤드가 프레젠테이션 레이어의 역할에 충실하지 못하고 월권을 하는 경우가 생기는데, 일정은 정해져 있고, 백앤드가 일정을 소화하지 못할 때, 프론트앤드 쪽에서 일을 처리하게 되기 때문이다. 또한 백앤드가 go, rust 등의 언어를 사용하고 있고 프론트앤드가 타입스크립트인 구성에서 각종 비즈니스 로직을 go나 rust로 만드는데 시간이 들고 어렵기 때문에 단순히 디비에 데이터를 저장하는 용도로 백앤드를 구성하고 프론트앤드에 로직을 추가하는 경우가 생길 수 있다.

하지만, 백앤드에서 처리해야 할 로직을 프론트에서 처리하게 될 경우 부정한 데이터 검증이 쉬운 데이터가 아니라 어려운 데이터가 전달되어 언제 어떻게 취약점이 발생할지 알 수 없게 될 수 있다. 프론트앤드가 해야 할 역할은 프론트가 백앤드가 맡아야 할 역할을 백앤드가 담당하도록 설계하는 것이 중요하다. 백앤드도 편한 언어를 써야 비즈니스 로직에 대한 처리를 프론트가 아닌 백앤드에서 담당하기 쉬워진다.

## 애플리케이션 속도에 대한 환상

각종 로직을 프론트앤드에서 구현을 하고 백앤드의 로직은 가능한 가볍게 유지하려고 하는 사람들이 있다. 백앤드에서 각종 연산을 처리하지 않고 프론트에서 각종 연산을 처리하기 때문에 서버에 가해지는 부하가 줄어들어 서버의 비용 절감 및 서버 스케일링에 대한 부담감을 줄일 수 있다는 장점 내세우곤한다. 보안이 그렇제 중요하지 않거나, 서버로 전송되는 각종 값들의 변조가 이뤄지더라도 별다른 문제가 없는 서비스의 경우에는 좋은 전략이 될 수 있을 것이다.

만약 데이터의 조작 및 변경에 민감한 도메인에서 프론트앤드로 로직을 전가하여 속도를 높인다는 전략을 쓰기 위해서는 프론트앤드에서 변환되는 값의 변화를 주의 깊게 설계를 해야 하고, 크리티컬한 영향을 미치는 값에 대해서는 프론트앤드에서 처리하지 않고 백앤드에 넘겨 주어야 한다. 만약 백앤드를 정말 심플하게 만들고자 한다면, 프론트앤드에서 전달된 데이터들에 대한 검증을 하기 위한 별도의 배치처리 등을 만들어 데이터가 정상적인지 검증을 해야 한다.

정말 서버 비용이 중요한 서비스, 너무나 많은 트레픽이 전달되어 컴퓨팅 리소스를 줄이는 것이 인건비를 늘리는 것 보다 더 큰 금액이 되는 경우, 서버로의 데이터 저장이 아닌 정보를 표시하는 기능 위주의 서비스에서는 유용할 수 있지만, 유저의 데이터 저장이 빈번하게 이뤄지는 서비스에 대해서는 데이터 검증의 어려움 및 데이터 변조의 위험이 쉽게 발생할 수 있어서 나쁜 전략이 될 수 있다는 것을 염두해야 한다.
